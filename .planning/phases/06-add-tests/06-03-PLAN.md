# Plan 06-03: Test hooks

## Goal

Add tests for custom React hooks to verify state management and localStorage behavior.

## Why

- Hooks contain critical business logic
- localStorage edge cases need coverage (corrupted data, missing data)
- These are the safety net tests for Phase 2 protections

## Hooks to Test

### useCatStorage
- Initial state from localStorage
- setCatFromUpload updates image and clears shelter cat
- setCatName updates name
- setCatFromShelter updates all fields
- clearCat removes all data
- **Edge cases:**
  - Corrupted localStorage JSON doesn't crash (try-catch from Phase 2)
  - Missing localStorage returns defaults

### useOracle
- Initial state (empty question, null response, not thinking)
- askOracle with empty question does nothing
- askOracle triggers isThinking state
- clearResponse resets response to null
- Note: timing tests are flaky, skip actual delay testing

## Tasks

### Task 1: Create src/hooks/useCatStorage.test.ts
- Test initial state with empty localStorage
- Test initial state with existing localStorage
- Test setCatFromUpload
- Test setCatName
- Test setCatFromShelter
- Test clearCat
- Test corrupted JSON handling (returns null, doesn't throw)

### Task 2: Create src/hooks/useOracle.test.ts
- Test initial state
- Test askOracle with empty question (no-op)
- Test clearResponse

### Task 3: Verify all tests pass
- Run `npm run test:run`
- Confirm no failures

## Verification

- [ ] src/hooks/useCatStorage.test.ts exists
- [ ] src/hooks/useOracle.test.ts exists
- [ ] All tests pass
- [ ] Corrupted localStorage test confirms Phase 2 protection works

## Notes

- Use @testing-library/react's renderHook for hook testing
- Mock localStorage with simple object implementation
- Don't test timing delays (flaky), test state changes
